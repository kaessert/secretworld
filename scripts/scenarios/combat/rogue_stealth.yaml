# Rogue stealth scenario - tests the Rogue's sneak and backstab mechanics
# Validates that the Rogue class can use sneak ability for stealth attacks
scenario:
  name: "Rogue Stealth Mechanics"
  description: "Test Rogue sneak ability and backstab attack bonus"
  seed: 42032
  config:
    max_commands: 40
    timeout: 120
    skip_character_creation: false
    character_creation_inputs:
      - "TestRogue"
      - "3"   # Rogue class
      - "2"   # Random stats
      - "yes"

  setup:
    - "dump_state"  # Get initial state

  steps:
    # Step 1: Verify we're the Rogue class
    - command: "status"
      assertions:
        - type: COMMAND_VALID
          field: ""
          value: true
          message: "Status command should be valid"
        - type: NARRATIVE_MATCH
          field: "last_narrative"
          value: "Rogue"
          message: "Character should be Rogue class"

    # Step 2: Get initial state
    - command: "dump_state"
      assertions:
        - type: CONTENT_PRESENT
          field: "health"
          value: true
          message: "Health should be tracked"

    # Step 3: Explore to potentially trigger combat
    - command: "go north"
      assertions:
        - type: COMMAND_VALID
          field: ""
          value: true
          message: "Movement should work"

    # Step 4: Continue exploration
    - command: "go east"
      assertions:
        - type: COMMAND_VALID
          field: ""
          value: true
          message: "Movement should work"

    # Step 5: Continue exploration
    - command: "go south"
      assertions:
        - type: COMMAND_VALID
          field: ""
          value: true
          message: "Movement should work"

    # Step 6: Continue exploration
    - command: "go west"
      assertions:
        - type: COMMAND_VALID
          field: ""
          value: true
          message: "Movement should work"

    # Step 7: Test sneak ability - core test of Rogue stealth
    - command: "sneak"
      assertions:
        - type: COMMAND_VALID
          field: ""
          value: true
          message: "Sneak command should be recognized for Rogue"

    # Step 8: Attack while sneaking for backstab bonus
    - command: "attack"
      assertions:
        - type: COMMAND_VALID
          field: ""
          value: true
          message: "Attack while sneaking should work"

    # Step 9: Check state after combat
    - command: "dump_state"
      assertions:
        - type: STATE_RANGE
          field: "health"
          value:
            min: 1
            max: 200
          message: "Health should be in valid range after combat"
