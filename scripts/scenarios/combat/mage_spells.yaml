# Mage spells scenario - tests the Mage's fireball and ice_bolt abilities
# Validates that the Mage class can use spell abilities in combat
scenario:
  name: "Mage Spell Abilities"
  description: "Test Mage fireball and ice_bolt spells in combat"
  seed: 42031
  config:
    max_commands: 40
    timeout: 120
    skip_character_creation: false
    character_creation_inputs:
      - "TestMage"
      - "2"   # Mage class
      - "2"   # Random stats
      - "yes"

  setup:
    - "dump_state"  # Get initial state

  steps:
    # Step 1: Verify we're the Mage class
    - command: "status"
      assertions:
        - type: COMMAND_VALID
          field: ""
          value: true
          message: "Status command should be valid"
        - type: NARRATIVE_MATCH
          field: "last_narrative"
          value: "Mage"
          message: "Character should be Mage class"

    # Step 2: Get initial state for mana tracking
    - command: "dump_state"
      assertions:
        - type: CONTENT_PRESENT
          field: "mana"
          value: true
          message: "Mana should be tracked for Mage"

    # Step 3: Explore to potentially trigger combat
    - command: "go north"
      assertions:
        - type: COMMAND_VALID
          field: ""
          value: true
          message: "Movement should work"

    # Step 4: Continue exploration
    - command: "go east"
      assertions:
        - type: COMMAND_VALID
          field: ""
          value: true
          message: "Movement should work"

    # Step 5: Continue exploration
    - command: "go south"
      assertions:
        - type: COMMAND_VALID
          field: ""
          value: true
          message: "Movement should work"

    # Step 6: Continue exploration
    - command: "go west"
      assertions:
        - type: COMMAND_VALID
          field: ""
          value: true
          message: "Movement should work"

    # Step 7: Test fireball ability - core test of Mage spell
    - command: "fireball"
      assertions:
        - type: COMMAND_VALID
          field: ""
          value: true
          message: "Fireball command should be recognized for Mage"

    # Step 8: Test ice_bolt ability - alternative spell
    - command: "ice_bolt"
      assertions:
        - type: COMMAND_VALID
          field: ""
          value: true
          message: "Ice bolt command should be recognized for Mage"

    # Step 9: Check mana after casting
    - command: "dump_state"
      assertions:
        - type: STATE_RANGE
          field: "mana"
          value:
            min: 0
            max: 200
          message: "Mana should be in valid range"
